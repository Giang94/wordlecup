<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/src/main/java/com/app/wordlecup/cup/controller/RoomController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/app/wordlecup/cup/controller/RoomController.java" />
              <option name="originalContent" value="package com.app.wordlecup.cup.controller;&#10;&#10;import com.app.wordlecup.cup.model.*;&#10;import com.app.wordlecup.cup.service.RoomStore;&#10;import org.springframework.http.HttpStatus;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.web.bind.annotation.*;&#10;import org.springframework.web.server.ResponseStatusException;&#10;&#10;import java.util.ArrayList;&#10;import java.util.Comparator;&#10;import java.util.List;&#10;import java.util.Map;&#10;import java.util.stream.Collectors;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/wordlecup/rooms&quot;)&#10;public class RoomController {&#10;&#10;    private final RoomStore roomStore;&#10;&#10;    public RoomController(RoomStore roomStore) {&#10;        this.roomStore = roomStore;&#10;    }&#10;&#10;    @PostMapping&#10;    public ResponseEntity&lt;Room&gt; createRoom(@RequestBody CreateRoomRequest req) {&#10;        Room room = roomStore.createRoom(req);&#10;        return ResponseEntity.ok(room);&#10;    }&#10;&#10;    @PostMapping(&quot;/{roomId}/join&quot;)&#10;    public ResponseEntity&lt;Player&gt; joinRoom(@PathVariable String roomId, @RequestBody JoinRoomRequest req) {&#10;        try {&#10;            Player player = roomStore.joinRoom(roomId, req);&#10;            return ResponseEntity.ok(player);&#10;        } catch (IllegalArgumentException e) {&#10;            if (e.getMessage() != null &amp;&amp; e.getMessage().toLowerCase().contains(&quot;room not found&quot;)) {&#10;                throw new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Room not found&quot;);&#10;            }&#10;            throw e;&#10;        }&#10;    }&#10;&#10;    @PostMapping(&quot;/{roomId}/start&quot;)&#10;    public ResponseEntity&lt;Void&gt; startGame(@PathVariable String roomId, @RequestBody StartGameRequest req) {&#10;        try {&#10;            roomStore.startGame(roomId, req);&#10;            return ResponseEntity.ok().build();&#10;        } catch (IllegalArgumentException e) {&#10;            if (e.getMessage() != null &amp;&amp; e.getMessage().toLowerCase().contains(&quot;room not found&quot;)) {&#10;                throw new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Room not found&quot;);&#10;            }&#10;            throw e;&#10;        }&#10;    }&#10;&#10;    @PostMapping(&quot;/{roomId}/guess&quot;)&#10;    public ResponseEntity&lt;PlayerGuessResult&gt; submitGuess(@PathVariable String roomId, @RequestBody PlayerGuessRequest req) {&#10;        try {&#10;            PlayerGuessResult result = roomStore.submitGuess(roomId, req);&#10;            return ResponseEntity.ok(result);&#10;        } catch (IllegalArgumentException e) {&#10;            if (e.getMessage() != null &amp;&amp; e.getMessage().toLowerCase().contains(&quot;room not found&quot;)) {&#10;                throw new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Room not found&quot;);&#10;            }&#10;            throw e;&#10;        }&#10;    }&#10;&#10;    @GetMapping(&quot;/{roomId}&quot;)&#10;    public ResponseEntity&lt;Room&gt; getRoom(@PathVariable String roomId) {&#10;        Room room = roomStore.getRoom(roomId);&#10;        if (room == null) {&#10;            throw new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Room not found&quot;);&#10;        }&#10;        roomStore.finishTimedOutPlayers(room);&#10;        return ResponseEntity.ok(room);&#10;    }&#10;&#10;    @GetMapping(&quot;/{roomId}/player/{playerId}&quot;)&#10;    public ResponseEntity&lt;Player&gt; getPlayerState(@PathVariable String roomId, @PathVariable String playerId) {&#10;        Room room = roomStore.getRoom(roomId);&#10;        if (room == null) {&#10;            throw new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Room not found&quot;);&#10;        }&#10;        roomStore.finishTimedOutPlayers(room);&#10;        Player player = roomStore.getPlayer(roomId, playerId);&#10;        return ResponseEntity.ok(player);&#10;    }&#10;&#10;    @GetMapping(&quot;/{roomId}/players&quot;)&#10;    public ResponseEntity&lt;?&gt; getPlayers(@PathVariable String roomId) {&#10;        Room room = roomStore.getRoom(roomId);&#10;        if (room == null) {&#10;            throw new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Room not found&quot;);&#10;        }&#10;        roomStore.finishTimedOutPlayers(room);&#10;        return ResponseEntity.ok(new ArrayList&lt;&gt;(room.getPlayers().values()));&#10;    }&#10;&#10;    @GetMapping(&quot;/{roomId}/round-stats&quot;)&#10;    public List&lt;Map&lt;String, Object&gt;&gt; getRoundStats(@PathVariable String roomId) {&#10;        Room room = roomStore.getRoom(roomId);&#10;        // Mark timed out players as finished before returning stats&#10;        roomStore.finishTimedOutPlayers(room);&#10;        int round = room.getCurrentRound();&#10;        return room.getPlayers().values().stream()&#10;                .map(player -&gt; {&#10;                    PlayerRoundState state = player.getRoundStates().get(round);&#10;                    Map&lt;String, Object&gt; map = new java.util.LinkedHashMap&lt;&gt;();&#10;                    map.put(&quot;playerId&quot;, player.getPlayerId());&#10;                    map.put(&quot;displayName&quot;, player.getDisplayName());&#10;                    map.put(&quot;guessCount&quot;, state != null ? state.getGuesses().size() : 0);&#10;                    map.put(&quot;timeTakenMillis&quot;, state != null ? state.getTimeTakenMillis() : 0);&#10;                    map.put(&quot;roundScore&quot;, state != null ? state.getRoundScore() : 0);&#10;                    map.put(&quot;totalScore&quot;, player.getTotalScore());&#10;                    return map;&#10;                })&#10;                .sorted(Comparator.comparingInt(m -&gt; (int) m.get(&quot;guessCount&quot;)))&#10;                .collect(Collectors.toList());&#10;    }&#10;&#10;    @PostMapping(&quot;/{roomId}/next-round&quot;)&#10;    public ResponseEntity&lt;Void&gt; startNextRound(@PathVariable String roomId, @RequestBody Map&lt;String, String&gt; req) {&#10;        String ownerId = req.get(&quot;ownerId&quot;);&#10;        try {&#10;            roomStore.startNextRound(roomId, ownerId);&#10;            return ResponseEntity.ok().build();&#10;        } catch (IllegalArgumentException e) {&#10;            throw new ResponseStatusException(HttpStatus.FORBIDDEN, e.getMessage());&#10;        }&#10;    }&#10;&#10;    @PostMapping(&quot;/{roomId}/restart&quot;)&#10;    public ResponseEntity&lt;Void&gt; restartGame(@PathVariable String roomId, @RequestBody Map&lt;String, String&gt; req) {&#10;        String ownerId = req.get(&quot;ownerId&quot;);&#10;        try {&#10;            roomStore.restartGame(roomId, ownerId);&#10;            return ResponseEntity.ok().build();&#10;        } catch (IllegalArgumentException e) {&#10;            throw new ResponseStatusException(HttpStatus.FORBIDDEN, e.getMessage());&#10;        }&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.app.wordlecup.cup.controller;&#10;&#10;import com.app.wordlecup.cup.model.*;&#10;import com.app.wordlecup.cup.service.RoomStore;&#10;import org.springframework.http.HttpStatus;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.web.bind.annotation.*;&#10;import org.springframework.web.server.ResponseStatusException;&#10;&#10;import java.util.ArrayList;&#10;import java.util.Comparator;&#10;import java.util.List;&#10;import java.util.Map;&#10;import java.util.stream.Collectors;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/wordlecup/rooms&quot;)&#10;public class RoomController {&#10;&#10;    private final RoomStore roomStore;&#10;&#10;    public RoomController(RoomStore roomStore) {&#10;        this.roomStore = roomStore;&#10;    }&#10;&#10;    @PostMapping&#10;    public ResponseEntity&lt;Room&gt; createRoom(@RequestBody CreateRoomRequest req) {&#10;        Room room = roomStore.createRoom(req);&#10;        return ResponseEntity.ok(room);&#10;    }&#10;&#10;    @PostMapping(&quot;/{roomId}/join&quot;)&#10;    public ResponseEntity&lt;Player&gt; joinRoom(@PathVariable String roomId, @RequestBody JoinRoomRequest req) {&#10;        try {&#10;            Player player = roomStore.joinRoom(roomId, req);&#10;            return ResponseEntity.ok(player);&#10;        } catch (IllegalArgumentException e) {&#10;            if (e.getMessage() != null &amp;&amp; e.getMessage().toLowerCase().contains(&quot;room not found&quot;)) {&#10;                throw new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Room not found&quot;);&#10;            }&#10;            throw e;&#10;        }&#10;    }&#10;&#10;    @PostMapping(&quot;/{roomId}/start&quot;)&#10;    public ResponseEntity&lt;Void&gt; startGame(@PathVariable String roomId, @RequestBody StartGameRequest req) {&#10;        try {&#10;            roomStore.startGame(roomId, req);&#10;            return ResponseEntity.ok().build();&#10;        } catch (IllegalArgumentException e) {&#10;            if (e.getMessage() != null &amp;&amp; e.getMessage().toLowerCase().contains(&quot;room not found&quot;)) {&#10;                throw new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Room not found&quot;);&#10;            }&#10;            throw e;&#10;        }&#10;    }&#10;&#10;    @PostMapping(&quot;/{roomId}/guess&quot;)&#10;    public ResponseEntity&lt;PlayerGuessResult&gt; submitGuess(@PathVariable String roomId, @RequestBody PlayerGuessRequest req) {&#10;        try {&#10;            PlayerGuessResult result = roomStore.submitGuess(roomId, req);&#10;            return ResponseEntity.ok(result);&#10;        } catch (IllegalArgumentException e) {&#10;            if (e.getMessage() != null &amp;&amp; e.getMessage().toLowerCase().contains(&quot;room not found&quot;)) {&#10;                throw new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Room not found&quot;);&#10;            }&#10;            throw e;&#10;        }&#10;    }&#10;&#10;    @GetMapping(&quot;/{roomId}&quot;)&#10;    public ResponseEntity&lt;Room&gt; getRoom(@PathVariable String roomId) {&#10;        Room room = roomStore.getRoom(roomId);&#10;        if (room == null) {&#10;            throw new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Room not found&quot;);&#10;        }&#10;        roomStore.finishTimedOutPlayers(room);&#10;        return ResponseEntity.ok(room);&#10;    }&#10;&#10;    @GetMapping(&quot;/{roomId}/player/{playerId}&quot;)&#10;    public ResponseEntity&lt;Player&gt; getPlayerState(@PathVariable String roomId, @PathVariable String playerId) {&#10;        Room room = roomStore.getRoom(roomId);&#10;        if (room == null) {&#10;            throw new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Room not found&quot;);&#10;        }&#10;        roomStore.finishTimedOutPlayers(room);&#10;        Player player = roomStore.getPlayer(roomId, playerId);&#10;        return ResponseEntity.ok(player);&#10;    }&#10;&#10;    @GetMapping(&quot;/{roomId}/players&quot;)&#10;    public ResponseEntity&lt;?&gt; getPlayers(@PathVariable String roomId) {&#10;        Room room = roomStore.getRoom(roomId);&#10;        if (room == null) {&#10;            throw new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Room not found&quot;);&#10;        }&#10;        roomStore.finishTimedOutPlayers(room);&#10;        return ResponseEntity.ok(new ArrayList&lt;&gt;(room.getPlayers().values()));&#10;    }&#10;&#10;    @GetMapping(&quot;/{roomId}/round-stats&quot;)&#10;    public List&lt;Map&lt;String, Object&gt;&gt; getRoundStats(@PathVariable String roomId) {&#10;        Room room = roomStore.getRoom(roomId);&#10;        // Mark timed out players as finished before returning stats&#10;        roomStore.finishTimedOutPlayers(room);&#10;        int round = room.getCurrentRound();&#10;        return room.getPlayers().values().stream()&#10;                .map(player -&gt; {&#10;                    PlayerRoundState state = player.getRoundStates().get(round);&#10;                    Map&lt;String, Object&gt; map = new java.util.LinkedHashMap&lt;&gt;();&#10;                    map.put(&quot;playerId&quot;, player.getPlayerId());&#10;                    map.put(&quot;displayName&quot;, player.getDisplayName());&#10;                    map.put(&quot;guessCount&quot;, state != null ? state.getGuesses().size() : 0);&#10;                    map.put(&quot;timeTakenMillis&quot;, state != null ? state.getTimeTakenMillis() : 0);&#10;                    map.put(&quot;roundScore&quot;, state != null ? state.getRoundScore() : 0);&#10;                    map.put(&quot;totalScore&quot;, player.getTotalScore());&#10;                    return map;&#10;                })&#10;                .sorted(Comparator.comparingInt(m -&gt; (int) m.get(&quot;guessCount&quot;)))&#10;                .collect(Collectors.toList());&#10;    }&#10;&#10;    @PostMapping(&quot;/{roomId}/next-round&quot;)&#10;    public ResponseEntity&lt;Void&gt; startNextRound(@PathVariable String roomId, @RequestBody Map&lt;String, String&gt; req) {&#10;        String ownerId = req.get(&quot;ownerId&quot;);&#10;        try {&#10;            roomStore.startNextRound(roomId, ownerId);&#10;            return ResponseEntity.ok().build();&#10;        } catch (IllegalArgumentException e) {&#10;            throw new ResponseStatusException(HttpStatus.FORBIDDEN, e.getMessage());&#10;        }&#10;    }&#10;&#10;    @PostMapping(&quot;/{roomId}/restart&quot;)&#10;    public ResponseEntity&lt;Void&gt; restartGame(@PathVariable String roomId, @RequestBody Map&lt;String, String&gt; req) {&#10;        String ownerId = req.get(&quot;ownerId&quot;);&#10;        try {&#10;            roomStore.restartGame(roomId, ownerId);&#10;            return ResponseEntity.ok().build();&#10;        } catch (IllegalArgumentException e) {&#10;            throw new ResponseStatusException(HttpStatus.FORBIDDEN, e.getMessage());&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/resources/static/lobby.html">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/resources/static/lobby.html" />
              <option name="originalContent" value="&lt;!DOCTYPE html&gt;&#10;&lt;html lang=&quot;en&quot;&gt;&#10;&lt;head&gt;&#10;    &lt;meta charset=&quot;UTF-8&quot;&gt;&#10;    &lt;title id=&quot;lobbyTitle&quot;&gt;Lobby&lt;/title&gt;&#10;    &lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot;&gt;&#10;&lt;/head&gt;&#10;&lt;body&gt;&#10;    &lt;div class=&quot;lobby-container&quot;&gt;&#10;        &lt;h1 id=&quot;lobbyHeader&quot;&gt;Lobby - &lt;span id=&quot;roomCode&quot;&gt;&lt;/span&gt; (&lt;span id=&quot;playerCount&quot;&gt;&lt;/span&gt;)&lt;/h1&gt;&#10;        &lt;div id=&quot;playerListContainer&quot;&gt;&#10;            &lt;h2&gt;Players Joined:&lt;/h2&gt;&#10;            &lt;ul id=&quot;playerList&quot;&gt;&lt;/ul&gt;&#10;        &lt;/div&gt;&#10;        &lt;div id=&quot;joinLinkContainer&quot;&gt;&#10;            &lt;h3&gt;Share this link to join:&lt;/h3&gt;&#10;            &lt;input type=&quot;text&quot; id=&quot;joinLink&quot; readonly style=&quot;width:90%&quot; /&gt;&#10;            &lt;button id=&quot;copyJoinLinkBtn&quot;&gt;Copy&lt;/button&gt;&#10;        &lt;/div&gt;&#10;        &lt;div id=&quot;lobbyStatus&quot; style=&quot;color:red;&quot;&gt;&lt;/div&gt;&#10;        &lt;button id=&quot;startGameBtn&quot; style=&quot;display:none;&quot;&gt;Start Game&lt;/button&gt;&#10;    &lt;/div&gt;&#10;    &lt;script src=&quot;lobby.js&quot;&gt;&lt;/script&gt;&#10;&lt;/body&gt;&#10;&lt;/html&gt;&#10;" />
              <option name="updatedContent" value="&lt;!DOCTYPE html&gt;&#13;&#10;&lt;html lang=&quot;en&quot;&gt;&#13;&#10;&lt;head&gt;&#13;&#10;    &lt;meta charset=&quot;UTF-8&quot;&gt;&#13;&#10;    &lt;title id=&quot;lobbyTitle&quot;&gt;Lobby&lt;/title&gt;&#13;&#10;    &lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot;&gt;&#13;&#10;&lt;/head&gt;&#13;&#10;&lt;body&gt;&#13;&#10;    &lt;div class=&quot;lobby-container&quot;&gt;&#13;&#10;        &lt;h1 id=&quot;lobbyHeader&quot;&gt;Lobby - &lt;span id=&quot;roomCode&quot;&gt;&lt;/span&gt; (&lt;span id=&quot;playerCount&quot;&gt;&lt;/span&gt;)&lt;/h1&gt;&#13;&#10;        &lt;div id=&quot;playerListContainer&quot;&gt;&#13;&#10;            &lt;h2&gt;Players Joined:&lt;/h2&gt;&#13;&#10;            &lt;ul id=&quot;playerList&quot;&gt;&lt;/ul&gt;&#13;&#10;        &lt;/div&gt;&#13;&#10;        &lt;div id=&quot;joinLinkContainer&quot;&gt;&#13;&#10;            &lt;h3&gt;Share this link to join:&lt;/h3&gt;&#13;&#10;            &lt;input type=&quot;text&quot; id=&quot;joinLink&quot; readonly style=&quot;width:90%&quot; /&gt;&#13;&#10;            &lt;button id=&quot;copyJoinLinkBtn&quot;&gt;Copy&lt;/button&gt;&#13;&#10;        &lt;/div&gt;&#13;&#10;        &lt;div id=&quot;lobbyStatus&quot; style=&quot;color:red;&quot;&gt;&lt;/div&gt;&#13;&#10;        &lt;button id=&quot;startGameBtn&quot; style=&quot;display:none;&quot;&gt;Start Game&lt;/button&gt;&#13;&#10;    &lt;/div&gt;&#13;&#10;    &lt;script src=&quot;lobby.js&quot;&gt;&lt;/script&gt;&#13;&#10;&lt;/body&gt;&#13;&#10;&lt;/html&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>